@model WFM.UI.Models.OrderView
@using WFM.BAL.Enums
@using WFM.BAL.Helpers

<style>
    .boxR {
        border-bottom: solid 1px !important;
        border-right: solid 1px;
        border-left: solid 1px;
        background-color: lightgrey;
        font-size:1.2em;
    }

    .boxL {
        border-bottom: solid 1px !important;
        border-right: solid 1px;
        font-size: 1.2em;
    }
    .desbox {
        border-right: solid 1px;
        border-top: solid 1px !important;
        font-size: 1.2em;
    }
    .totbox {
        border-bottom: solid 1px !important;
        border-right: solid 1px;
        border-left: solid 1px;
        font-size: 1.2em;
    }
    .totboxM {
        border-bottom: solid 1px !important;
        border-right: solid 1px;
        font-size: 1.2em;
    }
   


</style>
<div  class="row m-5" id="printThis">

    <table class="report-container" width="1100">
        <thead class="report-header">
            <tr>
                <td style="border-bottom:solid" class="report-header-cell">
                    <div class="row text">
                       
                        <div class="header-info col-5 text-left">
                            <img src="~/Resources/print-logo.png" width="230" />

                        </div>

                        <div class="header-info col-7 col-sm-7 text-right ">
                            <h1>PRODUCTION ORDER</h1>

                        </div>


                    </div>

                </td>

            </tr>
            <tr>
                <td>
                    <br />
                </td>
            </tr>
        </thead>

        <tbody class="report-content">

            <tr>
                <td class="report-content-cell">
                    <div class="main">
                        <div class="col-12">
                            <div class="row justify-content-lg-start">
                                <div class="col-1 col-sm-2 text-left">
                                    <p style="font-size:1.3em"><b>PO No</b></p>
                                </div>
                                <div class="col-2 col-sm-2">
                                    <p style="font-size:1.2em">:@Html.DisplayFor(q => q.Code)</p>
                                </div>

                                <div class="col-6 col-sm-6 text-right">
                                    <p style="font-size:1.3em"> <b>Channeled By</b></p>
                                </div>
                                <div class="col-2 col-sm-2">
                                    <p style="font-size:1.2em">:@Html.DisplayFor(q => q.Employee.Name)</p>


                                </div>


                            </div>
                            <div class="row justify-content-lg-start">
                                <div class="col-2 col-sm-2 text-left">

                                    <p style="font-size:1.3em"><b> Date</b></p>
                                </div>
                                <div class="col-2 col-sm-2">
                                    @if (Model != null && Model.CreatedDate != null)
                                    {
                                        <p style="font-size:1.2em">:@Html.DisplayFor(q => q.CreatedDateString)</p>
                                    }


                                </div>
                                <div class="col-6 col-sm-6 text-right">
                                    <p style="font-size:1.3em"> <b>Quotation No</b></p>
                                </div>
                                <div class="col-2 col-sm-2">
                                    <p style="font-size:1.2em">:@Html.DisplayFor(q => q.Quote.Code)</p>

                                </div>
                            </div>
                            <div class="row justify-content-lg-start">
                                <div class="col-2 col-sm-2 text-left">

                                    <p style="font-size:1.3em"><b>Delivery Date</b></p>
                                </div>
                                <div class="col-2 col-sm-2">

                                    @if (Model != null && Model.DeliveryDate != null)
                                    {
                                        <p style="font-size:1.2em">:@Convert.ToString(string.Format("{0:dd/MM/yyyy}", Model.DeliveryDate))</p>

                                    }

                                </div>
                                <div class="col-10 col-sm-6 text-right">
                                    <p style="font-size:1.3em"> <b>Designer</b></p>

                                </div>
                                <div class="col-2 col-sm-2">


                                    <p style="font-size:1.2em">:@Html.DisplayFor(q => q.Designer)</p>

                                </div>
                                <div class="col-10 col-sm-10 text-right">
                                    <p style="font-size:1.3em"> <b>Remarks</b></p>

                                </div>
                                <div class="col-2 col-sm-2">


                                    <p style="font-size:1.2em">:@Html.DisplayFor(q => q.Remarks)</p>

                                </div>
                            </div>

                        </div>
                        <br />
                    </div>
                </td>
            </tr>

            <tr>
                <td>

                    <div class="main">
                        <div class="col-12">
                            <div class="row box">
                                <div class="col-4 text-left ">

                                    <h5>  <b> Client Details</b></h5>

                                </div>

                            </div>
                            <div class="row">
                                <div style="border-top:solid 1px" class="col-2 col-sm-2 text-left boxR">
                                    <p> <b>Client</b></p>
                                </div>
                                <div style="border-top: solid 1px" class="col-3 col-sm-3 boxL">
                                    @Html.DisplayFor(q => q.Client.Name)
                                </div>
                                <div class="col-2 col-sm-2">

                                </div>
                                <div class="col-2 col-sm-2 text-right boxR" style="border-top: solid 1px">
                                    <p> <b>Delivery</b></p>
                                </div>
                                <div class="col-2 col-sm-2 boxL" style="border-top: solid 1px">
                                    @if (Model != null && Model.DeliveryTypeId != null)
                                    {
                                        var x = Model.GetDelivery(Model.DeliveryTypeId);
                                        @Html.DisplayFor(q => x)
                                    }


                                </div>

                            </div>

                            <div class="row">
                                <div class="col-2 col-sm-2 text-left boxR">
                                    <p> <b>Contact Person</b></p>
                                </div>
                                <div class="col-3 col-sm-3 boxL">
                                    @Html.DisplayFor(q => q.ContactPerson)
                                </div>
                                <div class="col-2 col-sm-2">

                                </div>
                                <div class="col-2 col-sm-2 text-right boxR">
                                    <p> <b>Location</b></p>
                                </div>
                                <div class="col-2 col-sm-2 boxL">
                                    @Html.DisplayFor(q => q.Location)
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-2 col-sm-2 text-left boxR">
                                    <p> <b>Contact Mobile</b></p>
                                </div>
                                <div class="col-3 col-sm-3 boxL">
                                    @Html.DisplayFor(q => q.ContactMobile)
                                </div>
                            </div>

                        </div>
                    </div>


                </td>

            </tr>
            <tr>
                <td>

                    <div class="main">
                        <br />
                        <div class="col-12">
                            <div style="border-top:groove" class="row">
                                <div class="col-4 text-left">
                                    <h5>  <b> <u>Production Instructions</u></b></h5>
                                </div>
                            </div>
                        </div>
                    </div>


                </td>

            </tr>
            @if (Model != null)
            {
                var i = 0;
                foreach (var item in Model.OrderItems)
                {
                    i = i + 1;
                    <tr>
                        <td>
                            <div class="main">
                                <div class="col-12 box">

                                    <div class="row">

                                        <div class="col-6 col-sm-6 text-left">
                                            <p style="font-size:110%"><b>Item @i</b></p>
                                        </div>
                                        <div class="col-6 col-sm-6 text-left">
                                            <p style="font-size:110%"><b>Description</b></p>
                                        </div>

                                    </div>
                                    <div class="row">

                                        <div style="border-top: solid 1px" class="col-3 col-sm-3 text-left boxR">
                                            Product
                                        </div>
                                        <div style="border-top: solid 1px" class="col-3 col-sm-3 text-left boxL">
                                            @item.Category.Name
                                        </div>
                                        <div class="col-6 col-sm-6 text-left desbox">
                                            @item.Description
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Size
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @item.Size
                                        </div>
                                        <div style="border-right:solid thin" class="col-6 col-sm-6 text-left">

                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Qty
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @item.Qty
                                        </div>
                                        <div style="border-right:solid thin" class="col-6 col-sm-6 text-left">

                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Visibility
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @Model.Getvisibility(@item.VisibilityId == 0 ? 3 : @item.VisibilityId)

                                        </div>
                                        <div style="border-right:solid thin" class="col-6 col-sm-6 text-left">

                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Illumination
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @Model.GetIllumination(@item.IlluminationId == 0 ? 7 : @item.IlluminationId)
                                        </div>
                                        <div class="col-6 col-sm-6 text-left boxL">

                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Special Instructions
                                        </div>
                                        <div class="col-9 col-sm-9 text-left boxL">
                                            @item.SpecialInstruction
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Installation
                                        </div>
                                        <div class="col-9 col-sm-9 text-left boxL">
                                            @item.Installation
                                        </div>

                                    </div>
                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Warranty for Framework
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">

                                            @if (@Model.GetWarranty(@item.FrameworkWarrantyPeriod) != "N/A")
                                            {
                                                <p>@Model.GetWarranty(@item.FrameworkWarrantyPeriod) Years</p>
                                            }
                                            else
                                            {
                                                @Model.GetWarranty(@item.FrameworkWarrantyPeriod)
                                            }



                                        </div>
                                        <div style="background-color:lightgrey" class="col-3 col-sm-3 text-left boxL">
                                            Warranty for Lettering
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">

                                            @if (@Model.GetWarranty(@item.LetteringWarrantyPeriod) != "N/A")
                                            {
                                                <p>@Model.GetWarranty(@item.LetteringWarrantyPeriod) Years</p>
                                            }
                                            else
                                            {
                                                @Model.GetWarranty(@item.LetteringWarrantyPeriod)
                                            }


                                        </div>

                                    </div>

                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Warranty for Illumination
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @*@Model.GetWarranty(@item.IlluminationWarrantyPeriod)*@

                                            @if (@Model.GetWarranty(@item.IlluminationWarrantyPeriod) != "N/A")
                                            {
                                                <p>@Model.GetWarranty(@item.IlluminationWarrantyPeriod) Years</p>
                                            }
                                            else
                                            {
                                                @Model.GetWarranty(@item.IlluminationWarrantyPeriod)
                                            }

                                        </div>
                                        <div class="col-6 col-sm-6 text-left boxL">

                                        </div>
                                    </div>

                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Cost
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @item.UnitCost.ToString("N2")
                                        </div>
                                        <div style="background-color:lightgrey" class="col-3 col-sm-3 text-left boxL">
                                            VAT(%)
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @item.VAT%
                                        </div>
                                    </div>

                                    <div class="row">

                                        <div class="col-3 col-sm-3 text-left boxR">
                                            Total Cost
                                        </div>
                                        <div class="col-3 col-sm-3 text-left boxL">
                                            @item.TotalCost.ToString("N2")
                                        </div>
                                        <div class="col-6 col-sm-6 text-left boxL">

                                        </div>
                                    </div>
                                </div>
                                <br /><br />
                            </div>
                        </td>
                    </tr>

                }

            }

            <tr>
                <td>

                    <div class="main">
                        <div class="col-12">
                            <div class="row">
                                <div style="border-top:solid thin" class="col-3 text-left boxR">
                                    Printing Department
                                </div>
                                <div style="border-top:solid thin" class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsPrintingDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Cutting Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsCuttingDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Plastic Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsPlasticDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Cladding Section
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsCladdingsection == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Art Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsArtDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Steel Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsSteelDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Screen Printing Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsScreenPrintingDept == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Production Department
                                </div>
                                <div class="col-1 text-center boxL">
                                    @if (Model != null && Model.IsProductionDepartment == true)
                                    {
                                        <p>X</p>
                                    }


                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Packing Department
                                </div>
                                <div class="col-1 text-center boxL  ">
                                    @if (Model != null && Model.IsPackingDepartment == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3 text-left boxR">
                                    Installation Team
                                </div>
                                <div class="col-1 text-center boxL  ">
                                    @if (Model != null && Model.IsInstallationTeam == true)
                                    {
                                        <p>X</p>
                                    }
                                </div>
                            </div>
                            <br />
                        </div>
                    </div>


                </td>

            </tr>

            <tr>
                <td>

                    <div style="border-top:groove" class="main">
                        <div class="col-12">
                            <div class="row">
                                <div class="col-4 text-left">

                                    <h5><b> <u>Payment Details </u></b></h5>

                                </div>


                            </div>

                            <div class="row">

                                <div class="col-4 col-sm-4 text-left">
                                    <p style="font-size:110%"><b>Item</b></p>
                                </div>
                                <div class="col-2 col-sm-2 text-left">
                                    <p style="font-size:110%"><b>Qty</b></p>
                                </div>
                                <div class="col-3 col-sm-3 text-left">
                                    <p style="font-size:110%"><b>Unit Price</b></p>
                                </div>
                                <div class="col-3 col-sm-3 text-left">
                                    <p style="font-size:110%"><b>Total Cost</b></p>
                                </div>

                            </div>

                        </div>
                    </div>


                </td>

            </tr>
            @*---------\Order Items/-------*@
            @if (Model != null)
            {
                foreach (var item in Model.OrderItems)
                {
                    <tr>
                        <td>
                            <div class="main">
                                <div class="col-12">
                                    <div class="row">
                                        <div style="border-top:solid 1px" class="col-4 text-left boxR">
                                            @item.Category.Name
                                        </div>
                                        <div style="border-top:solid 1px" class="col-2 text-left boxL">
                                            @item.Qty
                                        </div>
                                        <div style="border-top:solid 1px" class="col-3 text-left boxL">
                                            LKR @item.UnitCost.ToString("N2")
                                        </div>
                                        <div style="border-top:solid 1px" class="col-3 text-left boxL">
                                            LKR @item.TotalCost.ToString("N2")
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </td>
                    </tr>
                }

            }

            @*---------\Additional charges/-------*@
            @if (Model != null)
            {
                //var x = 0;
                foreach (var item in Model.AdditionalCharges)
                {
                    if (@item.AddCharge != "")
                    {

                        <tr>
                            <td>
                                <div class="main">
                                    <div class="col-12">
                                        <div class="row">
                                            <div style="border-top:solid 1px" class="col-4 text-left boxR">
                                                @item.AddCharge
                                            </div>
                                            <div style="border-top:solid 1px" class="col-2 text-left boxL">
                                                @item.Qty
                                            </div>
                                            <div style="border-top:solid 1px" class="col-3 text-left boxL">
                                                LKR @item.Cost.ToString("N2")
                                            </div>
                                            <div style="border-top:solid 1px" class="col-3 text-left boxL">
                                                LKR @item.TotalCost.ToString("N2")
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </td>
                        </tr>
                    }
                }

            }

            <tr>
                <td>
                    <div class="main">
                        <div class="col-12">
                            <div class="row">
                                <div style="border-top:solid 1px" class="col-4 text-left totbox">
                                    <b> Total Cost</b>
                                </div>

                                <div style="border-top:solid 1px" class="col-5 text-left totboxM">

                                </div>
                                <div style="border-top:solid 1px" class="col-3 text-left boxL">
                                    <b> LKR @Html.DisplayFor(q => q.OrderTotal)</b>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-4 text-left totbox">
                                    <b>VAT</b>
                                </div>

                                <div class="col-5 text-left totboxM">

                                </div>
                                <div class="col-3 text-left boxL">
                                    <b> LKR @Html.DisplayFor(q => q.VAT)</b>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4 text-left totbox">
                                    <b> Total Cost With VAT</b>
                                </div>

                                <div class="col-5 text-lef totboxM">

                                </div>
                                <div class="col-3 text-left boxL">


                                    <b> LKR @Html.DisplayFor(q => q.TotalWithVat)</b>




                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4 text-left totbox">
                                    <b>Advance Payment</b>
                                </div>

                                <div class="col-5 text-left totboxM">

                                </div>
                                <div class="col-3 text-left boxL">
                                    <b> LKR @Html.DisplayFor(q => q.AdvancePayment)</b>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4 text-left totbox">
                                    <b>  Balance Payment</b>
                                </div>

                                <div class="col-5 text-left totboxM">

                                </div>
                                <div class="col-3 text-left boxL">
                                    <b> LKR @Html.DisplayFor(q => q.BalancePayment)</b>
                                </div>
                            </div>

                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div>
                        <div class="col-12">
                            <br>
                            <div class="row">
                                <h5>  <b> <u>Attachments</u></b></h5>
                            </div>

                        </div>
                        <div class="col-12">


                            @if (Model != null)
                            {
                                foreach (var item in Model.OrderAttachments)
                                {
                                    var url = "UploadedFiles\\" + @item.AttachmentName;
                                    <div class="row">
                                        <a href=@url><span style="font-weight:700" target="_blank">@item.ActualName</span></a>
                                    </div>
                                }
                            }
                        </div>

                    </div>
                </td>
            </tr>
        </tbody>          
    </table>
   
</div>
